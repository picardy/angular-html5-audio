!function(a,b){"function"==typeof define&&define.amd?define(["angular"],b):"object"==typeof exports?module.exports=b(require("angular")):b(a.angular)}(this,function(a){"use strict";function b(){return{amplify:function(a,b){return a.map(function(a){return a*b})},decibels:function(a){var b=this.rms(a);return 20*(Math.log(b)/Math.log(10))},downsample:function(a,b){if(b%1!==0)throw"BufferUtils.downsample() expects the size argument to be an integer.";for(var c=[],d=0;d<a.length;d+=b)c.push(a[d]);return c},filter:function(a,b,c){"function"!=typeof c&&(c=function(a){return a});for(var d=0;d<a.numberOfChannels;d++){var e,f=a.getChannelData(d),g=b.getChannelData(d);for(e=0;e<f.length;e++)g[idx]=c(f[idx],idx,d)}},rms:function(a){var b=a.reduce(function(a,b){return a+b*b},0);return Math.sqrt(b/a.length)}}}function c(b,c){function d(a){a=a||{},this.setupContext(),this.size=a.size||e,this.processors={},a.stream&&this.setStream(a.stream)}var e=4096;d.prototype.setupContext=function(){this.context=new b.AudioContext,this.destination=this.context.destination,this.sampleRate=this.context.sampleRate},d.prototype.setStream=function(a){this.stream=a,this.source=this.context.createMediaStreamSource(this.stream)},d.prototype.createProcessor=function(b,d){if(this.processors.hasOwnProperty(b))throw"A processor named "+b+" is already attached to this context.";return this.processors[b]=c.createProcess(a.extend({context:this},d)),this.processors[b]},this.Context=d,this.createContext=function(a){return new d(a)}}function d(){this.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,this.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,this.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,this.getUserMedia&&(this.getUserMedia=a.bind(navigator,this.getUserMedia)),this.requestAnimationFrame&&(this.requestAnimationFrame=a.bind(window,this.requestAnimationFrame)),this.supported=function(){return!!this.getUserMedia&&!!this.AudioContext}}function e(a,b){function c(a){a=a||{},this.streaming=!1,this.waiting=!1,a.start&&this.start()}c.prototype.start=function(){var c=a.defer(),d=this;if(!b.supported())throw"Your device doesn't support getUserMedia.";return this.stream?(this.streaming||this.stream.start(),void c.resolve(this)):(this.waiting=!0,b.getUserMedia({audio:!0},function(a){d.stream=a,d.streaming=!0,d.waiting=!1,c.resolve(d)},function(a){d.streaming=!1,d.waiting=!1,c.reject(a)}),c.promise)},c.prototype.stop=function(){this.stream&&(this.stream.stop(),delete this.stream,this.streaming=!1,this.waiting=!1)},this.Mic=c,this.createMic=function(a){return new c(a)}}function f(){function b(a){a=a||{},this.initialize="function"==typeof a.process?a.initialize:this.initialize,this.process="function"==typeof a.process?a.process:this.process,this.input=a.input,this.output=a.output,a.context&&this.setContext(a.context),"function"==typeof this.initialize&&this.initialize.apply(this,arguments),this.connect(this.input,this.output)}b.prototype.setContext=function(a){this.context=a},b.prototype.setupProcessor=function(){if(!this.context)throw"AudioProcessor.createProcessor needs a context to create a processor on.";return this.processor=this.context.context.createScriptProcessor(this.context.size,1,1),this.processor},b.prototype.connect=function(b,c){if(this.input=b||this.input,this.output=c||this.output,!this.input&&!this.output)throw"Before connecting, an input or an output must be specified.";this.setupProcessor(),this.processor.onaudioprocess=a.bind(this,this.process),this.input&&this.input.connect(this.processor),this.output&&this.processor.connect(this.output)},b.prototype.disconnect=function(){(this.input||this.output)&&(this.input&&(this.input.disconnect(this.processor),delete this.input),this.output&&(this.processor.disconnect(this.output),delete this.output))},b.prototype.initialize=function(){},b.prototype.process=function(){},this.Process=b,this.createProcess=function(a){return new b(a)}}var g=a.module("ngHTML5Audio",[]);return g.service("HTML5AudioFeatures",d),g.service("HTML5AudioBufferUtils",b),g.service("HTML5AudioContext",c),g.service("HTML5AudioProcess",f),g.service("HTML5AudioMic",e),g});
//# sourceMappingURL=angular-html5-audio.min.js.map